import requests 
from bs4 import BeautifulSoup

url = 'http://localhost/nap/sqli/'
s = requests.Session()
# print(s.get(url).content)
payload = []

def get_forms(url):
    soup = BeautifulSoup(s.get(url).content, 'html.parse')
    return soup .find_all("form")

#get form detail
def form_detail(form):
    detailsOfForm = {}
    action = form.attrs.get("action").lower()
    method = form.attrs.get("method", "get").lower()
    inputs=[]
    #get data in form
    for input_tag in form.find_all("input"):
        input_type = input_tag.attrs.get("type", "text")
        input_name = input_tag.attrs.get("name")
        input_value = input_tag.attrs.get("value", "")
        inputs.append(
            {   
             "type": input_type,
             "name": input_name,
              "value": input_value
            }
        )
    detailsOfForm["action"] = action
    detailsOfForm["method"] = method
    detailsOfForm["inputs"] = inputs
    return detailsOfForm

def vulne(response):
    errors = {"quoted string not properly terminated", 
              "unclosed quotation mark after the character string",  
              "you have an error in your sql syntax;"} 
    for error in errors:
        if error in response.content.decode.lower():
            return True
        return False

def sqli_injection(url):
    forms = get_forms(url)
    print(f"[+] Detected {len(forms)} forms on {url}.") 
    
        